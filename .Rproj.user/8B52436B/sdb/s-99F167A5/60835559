{
    "contents" : "networkD3_wholeNetwork_nodes <- reactive({\n  ## Set selected.interactions as all multiparty.interactions\n  selected.interactions <- multiparty.interactions\n  \n  ## Drop excluded categoties from multiparty interactions\n  selected.interactions <- selected.interactions[selected.interactions$Event.or.Relationship.Type != input$networkD3_wholeNetwork_ExcludedCategory,]\n  \n  \n  ## Apply network.edges.function to selected.interactions\n  edges <- network.edges.function(selected.interactions)\n  ## Get nodes from edges\n  nodes.of.network <- unique(c(edges$Primary.Emlo_ID,edges$Secondary.Emlo_ID))\n  \n  ## Subset people.df by nodes in edges\n  nodes <- subset(people.df, iperson_id %in% nodes.of.network)\n  \n  ## Create df for networkD3\n  \n  ## Map node ids to numbers, recalling nodes MUST go from 0 to nrow(data)-1\n  networkD3_nodes <- data.frame(\"name\" = 0:(nrow(nodes)-1),\n                                \"group\" = rep(1,nrow(nodes)),\n                                \"size\" = rep(1,nrow(nodes)),\n                                \"surname\" = nodes$Surname)\n  \n  ## Return for use elsewhere\n  \n  networkD3_nodes\n  \n})\n\nnetworkD3_wholeNetwork_edges <- reactive({\n  \n  ## Set selected.interactions as all multiparty.interactions\n  selected.interactions <- multiparty.interactions\n  \n  ## Drop excluded categoties from multiparty interactions\n  selected.interactions <- selected.interactions[selected.interactions$Event.or.Relationship.Type != input$networkD3_wholeNetwork_ExcludedCategory,]\n  \n  \n  ## Apply network.edges.function to selected.interactions\n  edges <- network.edges.function(selected.interactions)\n  ## Get nodes from edges\n  nodes.of.network <- unique(c(edges$Primary.Emlo_ID,edges$Secondary.Emlo_ID))\n  \n  networkD3_edges <- data.frame(\"source\" = as.numeric(mapvalues(edges$Primary.Emlo_ID, from = nodes$iperson_id, to = 0:(nrow(nodes)-1),warn_missing = FALSE)),\n                                \"target\" = as.numeric(mapvalues(edges$Secondary.Emlo_ID, from = nodes$iperson_id, to = 0:(nrow(nodes)-1),warn_missing = FALSE)),\n                                \n                                \n                                ## Times the total number of connections by 10 and add 1 if of the highlighted category type\n                                ## Allows for testing off oddness for colour and size for the edge width\n                                \"value\" = 10*edges$Total.Connections+edges[,c(input$networkD3_wholeNetwork_highlightedCategory)],\n                                \"LinkColor\" = c(rep(\"lightblue\",100),rep(\"red\",nrow(edges)-100)))\n  \n  ## Return for use elsewhere\n  \n  networkD3_edges\n  \n})\n\noutput$networkD3_wholeNetwork <- renderForceNetwork({\n  \n  ## If not loaded yet, stop\n  \n  if (is.null(input$networkD3_wholeNetwork_highlightedCategory))\n    return()\n  \n  ## Load nodes\n  networkD3_nodes <- networkD3_wholeNetwork_nodes()\n  \n  ## Load edges\n  networkD3_edges <- networkD3_wholeNetwork_edges()\n  \n  print(str(networkD3_nodes))\n  print(str(networkD3_edges))\n  \n  ## Click script\n  \n  MyClickScript <- \"d3.select(this).select('circle').transition().duration(750).attr('r', 30);\n  Shiny.onInputChange('current_node_id', nodes)\"\n  \n  \n  forceNetwork(Links = networkD3_edges, Nodes = networkD3_nodes, Source = \"source\",\n               Target = \"target\", Value = \"value\", NodeID = \"surname\", zoom = TRUE,\n               Group = \"group\",\n               fontSize = 10,\n               # linkColour = rep(\"#bf3eff\",nrow(networkD3_edges)),\n               # linkColour = linkColors.by.highlight,\n               linkColour = JS('function(l) { return l.value % 2 == 0 ? \"#ff6666\" : \"lightblue\" }'),\n               opacityNoHover = FALSE)\n})",
    "created" : 1453220148024.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "1906599778",
    "id" : "60835559",
    "lastKnownWriteTime" : 498216206446,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}