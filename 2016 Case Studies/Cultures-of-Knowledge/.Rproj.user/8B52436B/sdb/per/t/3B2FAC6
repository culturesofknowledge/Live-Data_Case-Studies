{
    "contents" : "## =============================== License ========================================\n## ================================================================================\n## This work is distributed under the MIT license, included in the parent directory\n## Copyright Owner: University of Oxford\n## Date of Authorship: 2016\n## Author: Martin John Hadley (orcid.org/0000-0002-3039-6849)\n## Academic Contact: Arno Bosse (http://orcid.org/0000-0003-3681-1289)\n## Data Source: emlo.bodleian.ox.ac.uk\n## ================================================================================\n\n\n### ============= Import People Sheet ========================= ###\n\npeople.df <- read.csv(\"data/master_people_sheet.csv\")\n## Convert name to character vector for simplicity later\npeople.df$Person.Name <- as.character(people.df$Person.Name)\n## Sort by name\npeople.df <- people.df[order(people.df$Person.Name),]\n\n## ===== Add surnames\n## Empty character vector\nsurnames.list <- as.character()\n## If there's a comma assume first word is surname, otherwise keep whole name\nadd.surname.fn <- function(name){\n  if(grepl(\",\",name)){\n    surnames.list <<- append(surnames.list, sapply(strsplit(name, \",\"), \"[[\", 1))\n  } else {\n    surnames.list <<- append(surnames.list,name)\n  }\n}\n## lapply invisibly\ninvisible(lapply(people.df$Person.Name,function(x)add.surname.fn(x)))\n## Append surname column to people.df\npeople.df$Surname <- surnames.list\n\n### ============= Import Places Sheet =========================\nplaces.df <- read.csv(\"data/master_places_sheet.csv\")\n\n### ============= Import All Life Events ========================= \n\nlife.events.df <- read.csv(\"data/master_life_events_sheet.csv\")\nlife.events.df$Primary.Participant.Emlo_ID <- as.character(life.events.df$Primary.Participant.Emlo_ID)\nlife.events.df$Secondary.Participant.Emlo_ID <- as.character(life.events.df$Secondary.Participant.Emlo_ID)\n\n### ============= Non-self Referential Events (i.e. not births) =============\n\nmultiparty.interactions <- life.events.df[!is.na(life.events.df$Secondary.Participant.Emlo_ID),]\nmultiparty.interactions <- droplevels(multiparty.interactions)\n\n\n# ### ============== Old =========================\n# \n# # find the individuals that are documented in the people sheet\n# documented.people <- intersect(c(multiparty.interactions$Primary.Participant.Emlo_ID,\n#                                  multiparty.interactions$Secondary.Participant.Emlo_ID),people.df$iperson_id)\n# # All 148 documented people exist in the multiparty.interactions, 245 undocumented people are included!\n# # Remove undocumented individuals from the multiparty.interactions\n# # Only 272 interactions survive out of a total of 555 multiparty interactions in the original dataset.\n# # For now re-assign multiparty.interactions to these documented interactions:\n# \n# multiparty.interactions <- subset(multiparty.interactions,\n#                                   Primary.Participant.Emlo_ID %in% documented.people &\n#                                     Secondary.Participant.Emlo_ID %in% documented.people)\n\n# ### ============= Documented Interactions (including individuals with only self-referential events) ============= ###\n# \n# all.documented.interactions <- subset(life.events.df,\n#        Primary.Participant.Emlo_ID %in% documented.people &\n#          Secondary.Participant.Emlo_ID %in% documented.people)\n# \n# all.documented.interactions <- droplevels(all.documented.interactions)\n\n\n",
    "created" : 1454875095993.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "498485240",
    "id" : "3B2FAC6",
    "lastKnownWriteTime" : 1454715021,
    "path" : "~/Github/Live-Data_Case-Studies/2016 Case Studies/Cultures-of-Knowledge/server/data-processing.R",
    "project_path" : "server/data-processing.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}